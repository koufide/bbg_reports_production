pip 20.3.3 from /usr/lib/python2.7/site-packages/pip (python 2.7)
Python 3.9.4
pip 21.1.1 from /var/www/html/bbg-reports/flask/venv3/lib/python3.9/site-packages/pip (python 3.9)
this_python (3, 9)
==================== DEMARRAGE ====================
__main__
__getDeclencheurJournalier__
mesmodules.ConnexionPostgres
__getDeclencheursJournalier__
r: RealDictRow([('id_rd', 2974), ('date_proch_exec', None), ('now', datetime.datetime(2021, 5, 19, 13, 16, 3, 437770, tzinfo=psycopg2.tz.FixedOffsetTimezone(offset=0, name=None))), ('libelle', 'BLOTTER MVTS RUBR COMPTA 375 VEILLE'), ('rep_destination', 'QUOTIDIEN - BLOTTER MVTS RUBR COMPTA 375 VEILLE'), ('processus_id', 2962), ('sqlstr', "select *\nfrom (select a.datoper,\n               a.datval,\n               a.nooper,\n               b.client,\n               b.ncg,\n               b.nom,\n               b.devise,\n               c.tname,\n               d.cours12,\n               a.mntfrf,\n               a.mntdev,\n               a.libelle,\n               a.codopsc,\n               a.expl,\n           e.agencelib\nfrom mvtj a,\n     cpt b,\n     codopsc c,\n     agence e,\n     (select nooper, compte, mnt mntdev, cours12\n      from LIBROP\n      union\n      select nooper, comptec compte, mntdevc mntdev, cours12\n      from VIREST\n      union\n      select nooper, compted compte, mntdevd mntdev, cours12\n      from VIRINT\n      union\n      select nooper, creccpt compte, cavmnt1 mntdev, ccc cours12\n      from chab\n      union\n      select nooper, comptec compte, mntdevc mntdev, cours12\n      from guichet\n      union\n      select nooper, compted compte, mntdevd mntdev, cours12\n      from guichet) d\nwhere b.ncg in ('375700', '375800', '937000', '938000')\nand a.codopsc = c.codopsc\nand a.compte = b.compte\nand a.nooper = d.nooper\nand b.agence = e.agence\nunion\nselect a.datoper,\n       a.datval,\n       a.nooper,\n       b.client,\n       b.ncg,\n       b.nom,\n       b.devise,\n       c.tname,\n       to_number('') cours12,\n       a.mntfrf,\n       a.mntdev,\n       a.libelle,\n       a.codopsc,\n       a.expl,\n       d.agencelib    \nfrom mvtj a, cpt b, codopsc c,agence d\nwhere b.ncg in ('375700', '375800', '937000', '938000')\nand a.codopsc = c.codopsc\nand a.compte = b.compte\nand c.tname = 'POSCR'\nand b.agence = d.agence\nunion\nselect a.datoper,\n       a.datval,\n       a.nooper,\n       b.client,\n       b.ncg,\n       b.nom,\n       b.devise,\n       c.tname,\n       e.cours cours12,\n       a.mntfrf,\n       a.mntdev,\n       a.libelle,\n       a.codopsc,\n       a.expl,\n       f.agencelib\nfrom mvtj a, cpt b, codopsc c,chqregma d,devj e,agence f\nwhere a.codopsc = c.codopsc\nand a.compte = b.compte\nand a.nooper = d.nooper\nand d.devreg = e.devise\nand d.datoper = e.datoper \nand b.agence = f.agence\nand a.codopsc = 'RG620'       \n)\norder by devise, ncg\n"), ('id_r', 2970), ('date_exec', '2021-05-19'), ('heure_exec', '11:40'), ('frequence', 'JOURNALIER'), ('repeat_jours', 1), ('passdb', 'bbg2010query'), ('utidb', 'bbgquery'), ('serveur', '192.168.2.204'), ('port', '1521'), ('basedonnees', 'EXP'), ('code', 'CNX_ORACLE'), ('processus', 'FINCON')])
==== debut dt_string: 19/05/2021 13:16:03 
Date execution: 2021-05-19 11:40
datetime_exec_obj:  2021-05-19 11:40:00
sqlstr: 
        UPDATE requete_declencheur
        SET status='1'
        WHERE id=2974;
        
updated_rows: 1
mesmodules.MesFonctions
__genererFichier__
repertoire /mnt/win/Courant/FINCON/QUOTIDIEN - BLOTTER MVTS RUBR COMPTA 375 VEILLE
nomfichier BLOTTER_MVTS_RUBR_COMPTA_375_VEILLE_20210519_131603.xlsx
__testerLaConnexion__3__
code: CNX_ORACLE
serveur: 192.168.2.204
port: 1521
utidb: bbgquery
basedonnees: EXP
mesmodules.ConnexionOracle
bbgquery bbg2010query 192.168.2.204 1521 EXP
__res__ {'connexion': 'OK'}
testerLaConnexion:: {'connexion': 'OK'}
mesmodules.MesFonctions
__testerLaRequete2__
__testerLaRequete2__ , __code__ : CNX_ORACLE
__testerLaRequete2__ , sqlstr : select *
from (select a.datoper,
               a.datval,
               a.nooper,
               b.client,
               b.ncg,
               b.nom,
               b.devise,
               c.tname,
               d.cours12,
               a.mntfrf,
               a.mntdev,
               a.libelle,
               a.codopsc,
               a.expl,
           e.agencelib
from mvtj a,
     cpt b,
     codopsc c,
     agence e,
     (select nooper, compte, mnt mntdev, cours12
      from LIBROP
      union
      select nooper, comptec compte, mntdevc mntdev, cours12
      from VIREST
      union
      select nooper, compted compte, mntdevd mntdev, cours12
      from VIRINT
      union
      select nooper, creccpt compte, cavmnt1 mntdev, ccc cours12
      from chab
      union
      select nooper, comptec compte, mntdevc mntdev, cours12
      from guichet
      union
      select nooper, compted compte, mntdevd mntdev, cours12
      from guichet) d
where b.ncg in ('375700', '375800', '937000', '938000')
and a.codopsc = c.codopsc
and a.compte = b.compte
and a.nooper = d.nooper
and b.agence = e.agence
union
select a.datoper,
       a.datval,
       a.nooper,
       b.client,
       b.ncg,
       b.nom,
       b.devise,
       c.tname,
       to_number('') cours12,
       a.mntfrf,
       a.mntdev,
       a.libelle,
       a.codopsc,
       a.expl,
       d.agencelib    
from mvtj a, cpt b, codopsc c,agence d
where b.ncg in ('375700', '375800', '937000', '938000')
and a.codopsc = c.codopsc
and a.compte = b.compte
and c.tname = 'POSCR'
and b.agence = d.agence
union
select a.datoper,
       a.datval,
       a.nooper,
       b.client,
       b.ncg,
       b.nom,
       b.devise,
       c.tname,
       e.cours cours12,
       a.mntfrf,
       a.mntdev,
       a.libelle,
       a.codopsc,
       a.expl,
       f.agencelib
from mvtj a, cpt b, codopsc c,chqregma d,devj e,agence f
where a.codopsc = c.codopsc
and a.compte = b.compte
and a.nooper = d.nooper
and d.devreg = e.devise
and d.datoper = e.datoper 
and b.agence = f.agence
and a.codopsc = 'RG620'       
)
order by devise, ncg

mesmodules.ConnexionOracle
bbgquery bbg2010query 192.168.2.204 1521 EXP
testerLaRequete:: {'nombreligne': 192}
genererLeFichierV2(data) data: {'code': 'CNX_ORACLE', 'utidb': 'bbgquery', 'passdb': 'bbg2010query', 'serveur': '192.168.2.204', 'port': '1521', 'basedonnees': 'EXP', 'sqlstr': "select *\nfrom (select a.datoper,\n               a.datval,\n               a.nooper,\n               b.client,\n               b.ncg,\n               b.nom,\n               b.devise,\n               c.tname,\n               d.cours12,\n               a.mntfrf,\n               a.mntdev,\n               a.libelle,\n               a.codopsc,\n               a.expl,\n           e.agencelib\nfrom mvtj a,\n     cpt b,\n     codopsc c,\n     agence e,\n     (select nooper, compte, mnt mntdev, cours12\n      from LIBROP\n      union\n      select nooper, comptec compte, mntdevc mntdev, cours12\n      from VIREST\n      union\n      select nooper, compted compte, mntdevd mntdev, cours12\n      from VIRINT\n      union\n      select nooper, creccpt compte, cavmnt1 mntdev, ccc cours12\n      from chab\n      union\n      select nooper, comptec compte, mntdevc mntdev, cours12\n      from guichet\n      union\n      select nooper, compted compte, mntdevd mntdev, cours12\n      from guichet) d\nwhere b.ncg in ('375700', '375800', '937000', '938000')\nand a.codopsc = c.codopsc\nand a.compte = b.compte\nand a.nooper = d.nooper\nand b.agence = e.agence\nunion\nselect a.datoper,\n       a.datval,\n       a.nooper,\n       b.client,\n       b.ncg,\n       b.nom,\n       b.devise,\n       c.tname,\n       to_number('') cours12,\n       a.mntfrf,\n       a.mntdev,\n       a.libelle,\n       a.codopsc,\n       a.expl,\n       d.agencelib    \nfrom mvtj a, cpt b, codopsc c,agence d\nwhere b.ncg in ('375700', '375800', '937000', '938000')\nand a.codopsc = c.codopsc\nand a.compte = b.compte\nand c.tname = 'POSCR'\nand b.agence = d.agence\nunion\nselect a.datoper,\n       a.datval,\n       a.nooper,\n       b.client,\n       b.ncg,\n       b.nom,\n       b.devise,\n       c.tname,\n       e.cours cours12,\n       a.mntfrf,\n       a.mntdev,\n       a.libelle,\n       a.codopsc,\n       a.expl,\n       f.agencelib\nfrom mvtj a, cpt b, codopsc c,chqregma d,devj e,agence f\nwhere a.codopsc = c.codopsc\nand a.compte = b.compte\nand a.nooper = d.nooper\nand d.devreg = e.devise\nand d.datoper = e.datoper \nand b.agence = f.agence\nand a.codopsc = 'RG620'       \n)\norder by devise, ncg\n", 'processus': 'FINCON', 'libelle': 'BLOTTER MVTS RUBR COMPTA 375 VEILLE', 'repDestination': 'QUOTIDIEN - BLOTTER MVTS RUBR COMPTA 375 VEILLE'}
mesmodules.MesFonctions
__genererLeFichierV2__
{'code': 'CNX_ORACLE', 'utidb': 'bbgquery', 'passdb': 'bbg2010query', 'serveur': '192.168.2.204', 'port': '1521', 'basedonnees': 'EXP', 'sqlstr': "select *\nfrom (select a.datoper,\n               a.datval,\n               a.nooper,\n               b.client,\n               b.ncg,\n               b.nom,\n               b.devise,\n               c.tname,\n               d.cours12,\n               a.mntfrf,\n               a.mntdev,\n               a.libelle,\n               a.codopsc,\n               a.expl,\n           e.agencelib\nfrom mvtj a,\n     cpt b,\n     codopsc c,\n     agence e,\n     (select nooper, compte, mnt mntdev, cours12\n      from LIBROP\n      union\n      select nooper, comptec compte, mntdevc mntdev, cours12\n      from VIREST\n      union\n      select nooper, compted compte, mntdevd mntdev, cours12\n      from VIRINT\n      union\n      select nooper, creccpt compte, cavmnt1 mntdev, ccc cours12\n      from chab\n      union\n      select nooper, comptec compte, mntdevc mntdev, cours12\n      from guichet\n      union\n      select nooper, compted compte, mntdevd mntdev, cours12\n      from guichet) d\nwhere b.ncg in ('375700', '375800', '937000', '938000')\nand a.codopsc = c.codopsc\nand a.compte = b.compte\nand a.nooper = d.nooper\nand b.agence = e.agence\nunion\nselect a.datoper,\n       a.datval,\n       a.nooper,\n       b.client,\n       b.ncg,\n       b.nom,\n       b.devise,\n       c.tname,\n       to_number('') cours12,\n       a.mntfrf,\n       a.mntdev,\n       a.libelle,\n       a.codopsc,\n       a.expl,\n       d.agencelib    \nfrom mvtj a, cpt b, codopsc c,agence d\nwhere b.ncg in ('375700', '375800', '937000', '938000')\nand a.codopsc = c.codopsc\nand a.compte = b.compte\nand c.tname = 'POSCR'\nand b.agence = d.agence\nunion\nselect a.datoper,\n       a.datval,\n       a.nooper,\n       b.client,\n       b.ncg,\n       b.nom,\n       b.devise,\n       c.tname,\n       e.cours cours12,\n       a.mntfrf,\n       a.mntdev,\n       a.libelle,\n       a.codopsc,\n       a.expl,\n       f.agencelib\nfrom mvtj a, cpt b, codopsc c,chqregma d,devj e,agence f\nwhere a.codopsc = c.codopsc\nand a.compte = b.compte\nand a.nooper = d.nooper\nand d.devreg = e.devise\nand d.datoper = e.datoper \nand b.agence = f.agence\nand a.codopsc = 'RG620'       \n)\norder by devise, ncg\n", 'processus': 'FINCON', 'libelle': 'BLOTTER MVTS RUBR COMPTA 375 VEILLE', 'repDestination': 'QUOTIDIEN - BLOTTER MVTS RUBR COMPTA 375 VEILLE'}
mesmodules.ConnexionOracle
bbgquery bbg2010query 192.168.2.204 1521 EXP
       DATOPER     DATVAL   NOOPER  ... CODOPSC EXPL               AGENCELIB
0   2021-05-18 2021-05-18  7145113  ...      VI   3F  AGENCE - AG PRINCIPALE
1   2021-05-18 2021-05-18  7145114  ...      VI   3F  AGENCE - AG PRINCIPALE
2   2021-05-18 2021-05-18  7145414  ...      VI   3F  AGENCE - AG PRINCIPALE
3   2021-05-18 2021-05-18  7145471  ...   CHSTC   HF                   SIEGE
4   2021-05-18 2021-05-18  7152002  ...   CHSTC   HF                   SIEGE
..         ...        ...      ...  ...     ...  ...                     ...
187 2021-05-18 2021-05-18  7157048  ...   CHSVC   HF                   SIEGE
188 2021-05-18 2021-05-18  7152078  ...   CHSTC   HF                   SIEGE
189 2021-05-18 2021-05-18  7157045  ...   CHSVC   HF                   SIEGE
190 2021-05-18 2021-05-18  7157045  ...   CHSVC   HF                   SIEGE
191 2021-05-18 2021-05-18  7152078  ...   CHSTC   HF                   SIEGE

[192 rows x 15 columns]
/mnt/win/Courant
/mnt/win/Archives
xlsx
SheetName1
xlsxwriter
2021-05-19 13:16:35.287775
20210519_131635
BLOTTER MVTS RUBR COMPTA 375 VEILLE
res_gen: {'generation': 'OK'} 
res_gen OK 
2021-05-19 11:40:00
2021-05-20 11:40:00
sqlstr: 
        UPDATE requete_declencheur
        SET status='3', date_proch_exec='2021-05-20 11:40:00' 
        WHERE id=2974;
        
connection already closed
updated_rows: 0 
==== fin dt_string: 19/05/2021 13:16:35 
==== temps_ecoule: 31 seconde(s) 
pip 20.3.3 from /usr/lib/python2.7/site-packages/pip (python 2.7)
pip 20.3.3 from /usr/lib/python2.7/site-packages/pip (python 2.7)
Python 3.9.4
pip 21.1.1 from /var/www/html/bbg-reports/flask/venv3/lib/python3.9/site-packages/pip (python 3.9)
this_python (3, 9)
==================== DEMARRAGE ====================
__main__
__getDeclencheurJournalier__
mesmodules.ConnexionPostgres
__getDeclencheursJournalier__
pip 20.3.3 from /usr/lib/python2.7/site-packages/pip (python 2.7)
pip 20.3.3 from /usr/lib/python2.7/site-packages/pip (python 2.7)
Python 3.9.4
pip 21.1.1 from /var/www/html/bbg-reports/flask/venv3/lib/python3.9/site-packages/pip (python 3.9)
this_python (3, 9)
==================== DEMARRAGE ====================
__main__
__getDeclencheurJournalier__
mesmodules.ConnexionPostgres
__getDeclencheursJournalier__
pip 20.3.3 from /usr/lib/python2.7/site-packages/pip (python 2.7)
pip 20.3.3 from /usr/lib/python2.7/site-packages/pip (python 2.7)
Python 3.9.4
pip 21.1.1 from /var/www/html/bbg-reports/flask/venv3/lib/python3.9/site-packages/pip (python 3.9)
this_python (3, 9)
==================== DEMARRAGE ====================
__main__
__getDeclencheurJournalier__
mesmodules.ConnexionPostgres
__getDeclencheursJournalier__
pip 20.3.3 from /usr/lib/python2.7/site-packages/pip (python 2.7)
pip 20.3.3 from /usr/lib/python2.7/site-packages/pip (python 2.7)
Python 3.9.4
pip 21.1.1 from /var/www/html/bbg-reports/flask/venv3/lib/python3.9/site-packages/pip (python 3.9)
this_python (3, 9)
==================== DEMARRAGE ====================
__main__
__getDeclencheurJournalier__
mesmodules.ConnexionPostgres
__getDeclencheursJournalier__
pip 20.3.3 from /usr/lib/python2.7/site-packages/pip (python 2.7)
pip 20.3.3 from /usr/lib/python2.7/site-packages/pip (python 2.7)
Python 3.9.4
pip 21.1.1 from /var/www/html/bbg-reports/flask/venv3/lib/python3.9/site-packages/pip (python 3.9)
this_python (3, 9)
==================== DEMARRAGE ====================
__main__
__getDeclencheurJournalier__
mesmodules.ConnexionPostgres
__getDeclencheursJournalier__
pip 20.3.3 from /usr/lib/python2.7/site-packages/pip (python 2.7)
pip 20.3.3 from /usr/lib/python2.7/site-packages/pip (python 2.7)
Python 3.9.4
pip 21.1.1 from /var/www/html/bbg-reports/flask/venv3/lib/python3.9/site-packages/pip (python 3.9)
this_python (3, 9)
==================== DEMARRAGE ====================
__main__
__getDeclencheurJournalier__
mesmodules.ConnexionPostgres
__getDeclencheursJournalier__
pip 20.3.3 from /usr/lib/python2.7/site-packages/pip (python 2.7)
pip 20.3.3 from /usr/lib/python2.7/site-packages/pip (python 2.7)
Python 3.9.4
pip 21.1.1 from /var/www/html/bbg-reports/flask/venv3/lib/python3.9/site-packages/pip (python 3.9)
this_python (3, 9)
==================== DEMARRAGE ====================
__main__
__getDeclencheurJournalier__
mesmodules.ConnexionPostgres
__getDeclencheursJournalier__
pip 20.3.3 from /usr/lib/python2.7/site-packages/pip (python 2.7)
pip 20.3.3 from /usr/lib/python2.7/site-packages/pip (python 2.7)
Python 3.9.4
pip 21.1.1 from /var/www/html/bbg-reports/flask/venv3/lib/python3.9/site-packages/pip (python 3.9)
this_python (3, 9)
==================== DEMARRAGE ====================
__main__
__getDeclencheurJournalier__
mesmodules.ConnexionPostgres
__getDeclencheursJournalier__
pip 20.3.3 from /usr/lib/python2.7/site-packages/pip (python 2.7)
pip 20.3.3 from /usr/lib/python2.7/site-packages/pip (python 2.7)
Python 3.9.4
pip 21.1.1 from /var/www/html/bbg-reports/flask/venv3/lib/python3.9/site-packages/pip (python 3.9)
this_python (3, 9)
==================== DEMARRAGE ====================
__main__
__getDeclencheurJournalier__
mesmodules.ConnexionPostgres
__getDeclencheursJournalier__
pip 20.3.3 from /usr/lib/python2.7/site-packages/pip (python 2.7)
pip 20.3.3 from /usr/lib/python2.7/site-packages/pip (python 2.7)
Python 3.9.4
pip 21.1.1 from /var/www/html/bbg-reports/flask/venv3/lib/python3.9/site-packages/pip (python 3.9)
this_python (3, 9)
==================== DEMARRAGE ====================
__main__
__getDeclencheurJournalier__
mesmodules.ConnexionPostgres
__getDeclencheursJournalier__
pip 20.3.3 from /usr/lib/python2.7/site-packages/pip (python 2.7)
pip 20.3.3 from /usr/lib/python2.7/site-packages/pip (python 2.7)
Python 3.9.4
pip 21.1.1 from /var/www/html/bbg-reports/flask/venv3/lib/python3.9/site-packages/pip (python 3.9)
this_python (3, 9)
==================== DEMARRAGE ====================
__main__
__getDeclencheurJournalier__
mesmodules.ConnexionPostgres
__getDeclencheursJournalier__
r: RealDictRow([('id_rd', 2974), ('date_proch_exec', datetime.datetime(2021, 5, 19, 11, 40, tzinfo=psycopg2.tz.FixedOffsetTimezone(offset=0, name=None))), ('now', datetime.datetime(2021, 5, 19, 13, 27, 3, 196170, tzinfo=psycopg2.tz.FixedOffsetTimezone(offset=0, name=None))), ('libelle', 'BLOTTER MVTS RUBR COMPTA 375 VEILLE'), ('rep_destination', 'QUOTIDIEN - BLOTTER MVTS RUBR COMPTA 375 VEILLE'), ('processus_id', 2962), ('sqlstr', "select *\nfrom (select a.datoper,\n               a.datval,\n               a.nooper,\n               b.client,\n               b.ncg,\n               b.nom,\n               b.devise,\n               c.tname,\n               d.cours12,\n               a.mntfrf,\n               a.mntdev,\n               a.libelle,\n               a.codopsc,\n               a.expl,\n           e.agencelib\nfrom mvtj a,\n     cpt b,\n     codopsc c,\n     agence e,\n     (select nooper, compte, mnt mntdev, cours12\n      from LIBROP\n      union\n      select nooper, comptec compte, mntdevc mntdev, cours12\n      from VIREST\n      union\n      select nooper, compted compte, mntdevd mntdev, cours12\n      from VIRINT\n      union\n      select nooper, creccpt compte, cavmnt1 mntdev, ccc cours12\n      from chab\n      union\n      select nooper, comptec compte, mntdevc mntdev, cours12\n      from guichet\n      union\n      select nooper, compted compte, mntdevd mntdev, cours12\n      from guichet) d\nwhere b.ncg in ('375700', '375800', '937000', '938000')\nand a.codopsc = c.codopsc\nand a.compte = b.compte\nand a.nooper = d.nooper\nand b.agence = e.agence\nunion\nselect a.datoper,\n       a.datval,\n       a.nooper,\n       b.client,\n       b.ncg,\n       b.nom,\n       b.devise,\n       c.tname,\n       to_number('') cours12,\n       a.mntfrf,\n       a.mntdev,\n       a.libelle,\n       a.codopsc,\n       a.expl,\n       d.agencelib    \nfrom mvtj a, cpt b, codopsc c,agence d\nwhere b.ncg in ('375700', '375800', '937000', '938000')\nand a.codopsc = c.codopsc\nand a.compte = b.compte\nand c.tname = 'POSCR'\nand b.agence = d.agence\nunion\nselect a.datoper,\n       a.datval,\n       a.nooper,\n       b.client,\n       b.ncg,\n       b.nom,\n       b.devise,\n       c.tname,\n       e.cours cours12,\n       a.mntfrf,\n       a.mntdev,\n       a.libelle,\n       a.codopsc,\n       a.expl,\n       f.agencelib\nfrom mvtj a, cpt b, codopsc c,chqregma d,devj e,agence f\nwhere a.codopsc = c.codopsc\nand a.compte = b.compte\nand a.nooper = d.nooper\nand d.devreg = e.devise\nand d.datoper = e.datoper \nand b.agence = f.agence\nand a.codopsc = 'RG620'       \n)\norder by devise, ncg\n"), ('id_r', 2970), ('date_exec', '2021-05-19'), ('heure_exec', '11:40'), ('frequence', 'JOURNALIER'), ('repeat_jours', 1), ('passdb', 'bbg2010query'), ('utidb', 'bbgquery'), ('serveur', '192.168.2.204'), ('port', '1521'), ('basedonnees', 'EXP'), ('code', 'CNX_ORACLE'), ('processus', 'FINCON')])
==== debut dt_string: 19/05/2021 13:27:03 
Date execution: 2021-05-19 11:40
datetime_exec_obj:  2021-05-19 11:40:00
sqlstr: 
        UPDATE requete_declencheur
        SET status='1'
        WHERE id=2974;
        
updated_rows: 1
mesmodules.MesFonctions
__genererFichier__
repertoire /mnt/win/Courant/FINCON/QUOTIDIEN - BLOTTER MVTS RUBR COMPTA 375 VEILLE
nomfichier BLOTTER_MVTS_RUBR_COMPTA_375_VEILLE_20210519_132703.xlsx
__testerLaConnexion__3__
code: CNX_ORACLE
serveur: 192.168.2.204
port: 1521
utidb: bbgquery
basedonnees: EXP
mesmodules.ConnexionOracle
bbgquery bbg2010query 192.168.2.204 1521 EXP
__res__ {'connexion': 'OK'}
testerLaConnexion:: {'connexion': 'OK'}
mesmodules.MesFonctions
__testerLaRequete2__
__testerLaRequete2__ , __code__ : CNX_ORACLE
__testerLaRequete2__ , sqlstr : select *
from (select a.datoper,
               a.datval,
               a.nooper,
               b.client,
               b.ncg,
               b.nom,
               b.devise,
               c.tname,
               d.cours12,
               a.mntfrf,
               a.mntdev,
               a.libelle,
               a.codopsc,
               a.expl,
           e.agencelib
from mvtj a,
     cpt b,
     codopsc c,
     agence e,
     (select nooper, compte, mnt mntdev, cours12
      from LIBROP
      union
      select nooper, comptec compte, mntdevc mntdev, cours12
      from VIREST
      union
      select nooper, compted compte, mntdevd mntdev, cours12
      from VIRINT
      union
      select nooper, creccpt compte, cavmnt1 mntdev, ccc cours12
      from chab
      union
      select nooper, comptec compte, mntdevc mntdev, cours12
      from guichet
      union
      select nooper, compted compte, mntdevd mntdev, cours12
      from guichet) d
where b.ncg in ('375700', '375800', '937000', '938000')
and a.codopsc = c.codopsc
and a.compte = b.compte
and a.nooper = d.nooper
and b.agence = e.agence
union
select a.datoper,
       a.datval,
       a.nooper,
       b.client,
       b.ncg,
       b.nom,
       b.devise,
       c.tname,
       to_number('') cours12,
       a.mntfrf,
       a.mntdev,
       a.libelle,
       a.codopsc,
       a.expl,
       d.agencelib    
from mvtj a, cpt b, codopsc c,agence d
where b.ncg in ('375700', '375800', '937000', '938000')
and a.codopsc = c.codopsc
and a.compte = b.compte
and c.tname = 'POSCR'
and b.agence = d.agence
union
select a.datoper,
       a.datval,
       a.nooper,
       b.client,
       b.ncg,
       b.nom,
       b.devise,
       c.tname,
       e.cours cours12,
       a.mntfrf,
       a.mntdev,
       a.libelle,
       a.codopsc,
       a.expl,
       f.agencelib
from mvtj a, cpt b, codopsc c,chqregma d,devj e,agence f
where a.codopsc = c.codopsc
and a.compte = b.compte
and a.nooper = d.nooper
and d.devreg = e.devise
and d.datoper = e.datoper 
and b.agence = f.agence
and a.codopsc = 'RG620'       
)
order by devise, ncg

mesmodules.ConnexionOracle
bbgquery bbg2010query 192.168.2.204 1521 EXP
testerLaRequete:: {'nombreligne': 192}
genererLeFichierV2(data) data: {'code': 'CNX_ORACLE', 'utidb': 'bbgquery', 'passdb': 'bbg2010query', 'serveur': '192.168.2.204', 'port': '1521', 'basedonnees': 'EXP', 'sqlstr': "select *\nfrom (select a.datoper,\n               a.datval,\n               a.nooper,\n               b.client,\n               b.ncg,\n               b.nom,\n               b.devise,\n               c.tname,\n               d.cours12,\n               a.mntfrf,\n               a.mntdev,\n               a.libelle,\n               a.codopsc,\n               a.expl,\n           e.agencelib\nfrom mvtj a,\n     cpt b,\n     codopsc c,\n     agence e,\n     (select nooper, compte, mnt mntdev, cours12\n      from LIBROP\n      union\n      select nooper, comptec compte, mntdevc mntdev, cours12\n      from VIREST\n      union\n      select nooper, compted compte, mntdevd mntdev, cours12\n      from VIRINT\n      union\n      select nooper, creccpt compte, cavmnt1 mntdev, ccc cours12\n      from chab\n      union\n      select nooper, comptec compte, mntdevc mntdev, cours12\n      from guichet\n      union\n      select nooper, compted compte, mntdevd mntdev, cours12\n      from guichet) d\nwhere b.ncg in ('375700', '375800', '937000', '938000')\nand a.codopsc = c.codopsc\nand a.compte = b.compte\nand a.nooper = d.nooper\nand b.agence = e.agence\nunion\nselect a.datoper,\n       a.datval,\n       a.nooper,\n       b.client,\n       b.ncg,\n       b.nom,\n       b.devise,\n       c.tname,\n       to_number('') cours12,\n       a.mntfrf,\n       a.mntdev,\n       a.libelle,\n       a.codopsc,\n       a.expl,\n       d.agencelib    \nfrom mvtj a, cpt b, codopsc c,agence d\nwhere b.ncg in ('375700', '375800', '937000', '938000')\nand a.codopsc = c.codopsc\nand a.compte = b.compte\nand c.tname = 'POSCR'\nand b.agence = d.agence\nunion\nselect a.datoper,\n       a.datval,\n       a.nooper,\n       b.client,\n       b.ncg,\n       b.nom,\n       b.devise,\n       c.tname,\n       e.cours cours12,\n       a.mntfrf,\n       a.mntdev,\n       a.libelle,\n       a.codopsc,\n       a.expl,\n       f.agencelib\nfrom mvtj a, cpt b, codopsc c,chqregma d,devj e,agence f\nwhere a.codopsc = c.codopsc\nand a.compte = b.compte\nand a.nooper = d.nooper\nand d.devreg = e.devise\nand d.datoper = e.datoper \nand b.agence = f.agence\nand a.codopsc = 'RG620'       \n)\norder by devise, ncg\n", 'processus': 'FINCON', 'libelle': 'BLOTTER MVTS RUBR COMPTA 375 VEILLE', 'repDestination': 'QUOTIDIEN - BLOTTER MVTS RUBR COMPTA 375 VEILLE'}
mesmodules.MesFonctions
__genererLeFichierV2__
{'code': 'CNX_ORACLE', 'utidb': 'bbgquery', 'passdb': 'bbg2010query', 'serveur': '192.168.2.204', 'port': '1521', 'basedonnees': 'EXP', 'sqlstr': "select *\nfrom (select a.datoper,\n               a.datval,\n               a.nooper,\n               b.client,\n               b.ncg,\n               b.nom,\n               b.devise,\n               c.tname,\n               d.cours12,\n               a.mntfrf,\n               a.mntdev,\n               a.libelle,\n               a.codopsc,\n               a.expl,\n           e.agencelib\nfrom mvtj a,\n     cpt b,\n     codopsc c,\n     agence e,\n     (select nooper, compte, mnt mntdev, cours12\n      from LIBROP\n      union\n      select nooper, comptec compte, mntdevc mntdev, cours12\n      from VIREST\n      union\n      select nooper, compted compte, mntdevd mntdev, cours12\n      from VIRINT\n      union\n      select nooper, creccpt compte, cavmnt1 mntdev, ccc cours12\n      from chab\n      union\n      select nooper, comptec compte, mntdevc mntdev, cours12\n      from guichet\n      union\n      select nooper, compted compte, mntdevd mntdev, cours12\n      from guichet) d\nwhere b.ncg in ('375700', '375800', '937000', '938000')\nand a.codopsc = c.codopsc\nand a.compte = b.compte\nand a.nooper = d.nooper\nand b.agence = e.agence\nunion\nselect a.datoper,\n       a.datval,\n       a.nooper,\n       b.client,\n       b.ncg,\n       b.nom,\n       b.devise,\n       c.tname,\n       to_number('') cours12,\n       a.mntfrf,\n       a.mntdev,\n       a.libelle,\n       a.codopsc,\n       a.expl,\n       d.agencelib    \nfrom mvtj a, cpt b, codopsc c,agence d\nwhere b.ncg in ('375700', '375800', '937000', '938000')\nand a.codopsc = c.codopsc\nand a.compte = b.compte\nand c.tname = 'POSCR'\nand b.agence = d.agence\nunion\nselect a.datoper,\n       a.datval,\n       a.nooper,\n       b.client,\n       b.ncg,\n       b.nom,\n       b.devise,\n       c.tname,\n       e.cours cours12,\n       a.mntfrf,\n       a.mntdev,\n       a.libelle,\n       a.codopsc,\n       a.expl,\n       f.agencelib\nfrom mvtj a, cpt b, codopsc c,chqregma d,devj e,agence f\nwhere a.codopsc = c.codopsc\nand a.compte = b.compte\nand a.nooper = d.nooper\nand d.devreg = e.devise\nand d.datoper = e.datoper \nand b.agence = f.agence\nand a.codopsc = 'RG620'       \n)\norder by devise, ncg\n", 'processus': 'FINCON', 'libelle': 'BLOTTER MVTS RUBR COMPTA 375 VEILLE', 'repDestination': 'QUOTIDIEN - BLOTTER MVTS RUBR COMPTA 375 VEILLE'}
mesmodules.ConnexionOracle
bbgquery bbg2010query 192.168.2.204 1521 EXP
       DATOPER     DATVAL   NOOPER  ... CODOPSC EXPL               AGENCELIB
0   2021-05-18 2021-05-18  7145113  ...      VI   3F  AGENCE - AG PRINCIPALE
1   2021-05-18 2021-05-18  7145114  ...      VI   3F  AGENCE - AG PRINCIPALE
2   2021-05-18 2021-05-18  7145414  ...      VI   3F  AGENCE - AG PRINCIPALE
3   2021-05-18 2021-05-18  7145471  ...   CHSTC   HF                   SIEGE
4   2021-05-18 2021-05-18  7152002  ...   CHSTC   HF                   SIEGE
..         ...        ...      ...  ...     ...  ...                     ...
187 2021-05-18 2021-05-18  7157048  ...   CHSVC   HF                   SIEGE
188 2021-05-18 2021-05-18  7152078  ...   CHSTC   HF                   SIEGE
189 2021-05-18 2021-05-18  7157045  ...   CHSVC   HF                   SIEGE
190 2021-05-18 2021-05-18  7157045  ...   CHSVC   HF                   SIEGE
191 2021-05-18 2021-05-18  7152078  ...   CHSTC   HF                   SIEGE

[192 rows x 15 columns]
/mnt/win/Courant
/mnt/win/Archives
xlsx
SheetName1
xlsxwriter
2021-05-19 13:27:34.284064
20210519_132734
BLOTTER MVTS RUBR COMPTA 375 VEILLE
res_gen: {'generation': 'OK'} 
res_gen OK 
2021-05-19 11:40:00
2021-05-20 11:40:00
sqlstr: 
        UPDATE requete_declencheur
        SET status='3', date_proch_exec='2021-05-20 11:40:00' 
        WHERE id=2974;
        
updated_rows: 1 
==== fin dt_string: 19/05/2021 13:27:34 
==== temps_ecoule: 31 seconde(s) 
pip 20.3.3 from /usr/lib/python2.7/site-packages/pip (python 2.7)
pip 20.3.3 from /usr/lib/python2.7/site-packages/pip (python 2.7)
Python 3.9.4
pip 21.1.1 from /var/www/html/bbg-reports/flask/venv3/lib/python3.9/site-packages/pip (python 3.9)
this_python (3, 9)
==================== DEMARRAGE ====================
__main__
__getDeclencheurJournalier__
mesmodules.ConnexionPostgres
__getDeclencheursJournalier__
pip 20.3.3 from /usr/lib/python2.7/site-packages/pip (python 2.7)
pip 20.3.3 from /usr/lib/python2.7/site-packages/pip (python 2.7)
Python 3.9.4
pip 21.1.1 from /var/www/html/bbg-reports/flask/venv3/lib/python3.9/site-packages/pip (python 3.9)
this_python (3, 9)
==================== DEMARRAGE ====================
__main__
__getDeclencheurJournalier__
mesmodules.ConnexionPostgres
__getDeclencheursJournalier__
pip 20.3.3 from /usr/lib/python2.7/site-packages/pip (python 2.7)
pip 20.3.3 from /usr/lib/python2.7/site-packages/pip (python 2.7)
Python 3.9.4
pip 21.1.1 from /var/www/html/bbg-reports/flask/venv3/lib/python3.9/site-packages/pip (python 3.9)
this_python (3, 9)
==================== DEMARRAGE ====================
__main__
__getDeclencheurJournalier__
mesmodules.ConnexionPostgres
__getDeclencheursJournalier__
pip 20.3.3 from /usr/lib/python2.7/site-packages/pip (python 2.7)
pip 20.3.3 from /usr/lib/python2.7/site-packages/pip (python 2.7)
Python 3.9.4
pip 21.1.1 from /var/www/html/bbg-reports/flask/venv3/lib/python3.9/site-packages/pip (python 3.9)
this_python (3, 9)
==================== DEMARRAGE ====================
__main__
__getDeclencheurJournalier__
mesmodules.ConnexionPostgres
__getDeclencheursJournalier__
pip 20.3.3 from /usr/lib/python2.7/site-packages/pip (python 2.7)
